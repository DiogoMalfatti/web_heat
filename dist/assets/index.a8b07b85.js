import{a as N,j as v,r as o,V as b,l as W,b as S,R as y,c as L}from"./vendor.82442e6a.js";const M=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}};M();const m=N.create({baseURL:"http://localhost:4000"}),s=v.exports.jsx,c=v.exports.jsxs,p=o.exports.createContext({});function C(e){const[i,t]=o.exports.useState(null),l="https://github.com/login/oauth/authorize?scope=user&client_id=78d7b82b1eb4967a9444";async function n(r){const d=await m.post("authenticate",{code:r}),{token:h,user:_}=d.data;localStorage.setItem("@dowhile:token",h),m.defaults.headers.common.authorization=`Bearer ${h}`,t(_)}function a(){t(null),localStorage.removeItem("@dowhile:token")}return o.exports.useEffect(()=>{const r=localStorage.getItem("@dowhile:token");r&&(m.defaults.headers.common.authorization=`Bearer ${r}`,m.get("profile").then(d=>{t(d.data)}))},[]),o.exports.useEffect(()=>{const r=window.location.href;if(r.includes("?code=")){const[h,_]=r.split("?code=");window.history.pushState({},"",h),n(_)}},[]),s(p.Provider,{value:{signInUrl:l,user:i,signOut:a},children:e.children})}const B="_loginBoxWrapper_12h1l_1",G="_signInWithGithub_12h1l_17";var x={loginBoxWrapper:B,signInWithGithub:G};function O(){const{signInUrl:e}=o.exports.useContext(p);return c("div",{className:x.loginBoxWrapper,children:[s("strong",{children:"Entre e compartilhe sua mensagem"}),c("a",{href:e,className:x.signInWithGithub,children:[s(b,{size:"24"}),"Entrar com GitHub"]})]})}const w="_messageListWrapper_13lmc_1",F="_messageList_13lmc_1",E="_message_13lmc_1",k="_messageContent_13lmc_26",U="_messageUser_13lmc_30",$="_userImage_13lmc_35";var g={messageListWrapper:w,messageList:F,message:E,messageContent:k,messageUser:U,userImage:$},j="/assets/logo.2a5e2196.svg";const f=[],z=W("http://localhost:4000");z.on("new_message",e=>{f.push(e)});function R(){const[e,i]=o.exports.useState([]);return o.exports.useEffect(()=>{setInterval(()=>{f.length>0&&(i(t=>[f[0],t[0],t[1]].filter(Boolean)),f.shift())},3e3)},[]),o.exports.useEffect(()=>{m.get("messages/last3").then(t=>{i(t.data)})},[]),c("div",{className:g.messageListWrapper,children:[s("img",{src:j,alt:"DoWhile 2021"}),s("ul",{className:g.messageList,children:e.map(t=>c("li",{className:g.message,children:[s("p",{className:g.messageContent,children:t.text}),c("div",{className:g.messageUser,children:[s("div",{className:g.userImage,children:s("img",{src:t.user.avatar_url,alt:t.user.name})}),s("span",{children:t.user.name})]})]},t.id))})]})}const A="_contentWrapper_cfial_1",P="_contentSigned_cfial_11";var I={contentWrapper:A,contentSigned:P};const D="_SendMessageFormWrapper_18abv_1",V="_signOutButton_18abv_12",Q="_userInformation_18abv_25",q="_userImage_18abv_30",H="_userName_18abv_42",K="_userGithub_18abv_47",J="_sendMessageForm_18abv_57";var u={SendMessageFormWrapper:D,signOutButton:V,userInformation:Q,userImage:q,userName:H,userGithub:K,sendMessageForm:J};function T(){const{user:e,signOut:i}=o.exports.useContext(p),[t,l]=o.exports.useState("");async function n(a){a.preventDefault(),!!t.trim()&&(await m.post("messages",{message:t}),l(""))}return c("div",{className:u.SendMessageFormWrapper,children:[s("button",{onClick:i,className:u.signOutButton,children:s(S,{size:"32"})}),c("header",{className:u.userInformation,children:[s("div",{className:u.userImage,children:s("img",{src:e==null?void 0:e.avatar_url,alt:e==null?void 0:e.name})}),s("strong",{className:u.userName,children:e==null?void 0:e.name}),c("span",{className:u.userGithub,children:[s(b,{size:"16"}),e==null?void 0:e.login]})]}),c("form",{onSubmit:n,className:u.sendMessageForm,children:[s("label",{htmlFor:"message",children:"Mensagem"}),s("textarea",{name:"message",id:"message",placeholder:"Qual sua expectativa para o evento ?",onChange:a=>l(a.target.value),value:t}),s("button",{type:"submit",children:"Enviar mensagem"})]})]})}function X(){const{user:e}=o.exports.useContext(p);return c("main",{className:`${I.contentWrapper} ${e?I.contentSigned:""}`,children:[s(R,{}),e?s(T,{}):s(O,{})]})}y.render(s(L.StrictMode,{children:s(C,{children:s(X,{})})}),document.getElementById("root"));
